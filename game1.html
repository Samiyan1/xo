<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Game</title>

	<meta name="theme-color" content="Â£fff" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
	<link rel="icon" href="./static/home/Untitled-1.png" />


	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<link href="./static/home/index.css" rel="stylesheet">
	<style>
		.board {
			height: 600px;
			width: 600px;
		}

		.cell {
			height: 25vh;
			width: 25vh;
			cursor: pointer;
			text-align: center;

		}

		.cells {

			text-decoration: none;
			text-align: center;
			line-height: 20vh;
			font-size: 12vw;

		}

		.cells.fill-x::after {
			content: "X";
			color: blue;
			cursor: not-allowed;
		}

		.cells.fill-o::after {
			content: "O";
			color: red;
			cursor: not-allowed;
		}

		body {
			background-color: #DDD;
		}

		.hilight {
			background-color: rgb(187, 239, 199) !important;
		}
	</style>
	<meta http-equiv="X-UA-Compatible" content="ie=edge" />
	<style>
		body {
			font-family: "Arial", sans-serif;
		}

		section {
			text-align: center;
		}

		.game-grid-container {
			display: grid;
			grid-template-columns: 5% 25% 5% 25% 5% 25% 5%;
			grid-template-rows: 5% 25% 5% 25% 5% 25% 5%;
			width: 400px;
			height: 400px;
			margin: 30px auto;
		}

		.dot {
			width: 10px;
			height: 10px;

			border-radius: 50px;
			margin: auto;
			background-color: rgb(83, 81, 81);
		}

		.line-horizontal {
			height: 5px;
			background-color: lightgray;
			width: 100%;
			cursor: pointer;
			border-radius: 5px;
			margin: auto;
		}

		.line-vertical {
			height: 100%;
			width: 5px;
			background-color: lightgray;
			cursor: pointer;
			border-radius: 5px;
			margin: auto;
		}

		.bg-red,
		.hover-red:hover {
			background-color: rgb(255, 100, 131);
		}

		.bg-blue,
		.hover-blue:hover {
			background-color: rgb(136, 136, 253);
		}

		.box {
			width: 100%;
		}
	</style>

</head>
<header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-2 mb-0 meshki">
	<a href="/" class="d-flex align-items-center col-md-3 mb-2 mb-md-0 text-dark text-decoration-none">
		<img src="./static/home/Untitled-1.png" width="70" height="60" class="mx-4">
	</a>

	<ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0 ">
		<li><a href="#" class="nav-link px-2 link-light active">Home</a></li>
		<li><a href="#" class="nav-link px-2 link-light">Features</a></li>
		<li><a href="#" class="nav-link px-2 link-light">Pricing</a></li>
		<li><a href="#" class="nav-link px-2 link-light">FAQs</a></li>
		<li><a href="#" class="nav-link px-2 link-light">About</a></li>
	</ul>

	<div class="d-flex justify-content-md-end col-md-3 text-end  ">



		<a href="#" class=" link-dark text-decoration-none mx-4 felesh" id="dropdownUser1" data-bs-toggle="dropdown"
			aria-expanded="false">
			<img src="static/home/account-269.png" alt="mdo" width="40" height="40" class="rounded-circle circleprofile">
		</a>
		<ul class="dropdown-menu text-small felesh" aria-labelledby="dropdownUser1" style="z-index:2000;">
			<li><a class="dropdown-item" href="#">New project...</a></li>
			<li><a class="dropdown-item" href="#">Settings</a></li>
			<li><a class="dropdown-item" href="#">Profile</a></li>
			<li>
				<hr class="dropdown-divider">
			</li>
			<li><a class="dropdown-item" href="#">Log out</a></li>
		</ul>
	</div>
</header>
<!--HEADER-->

<!--navbar-->

<!--navbar-->

<nav class="navbar navbar-expand-sm navbar-dark meshki py-0 navbarbala d-flex justify-content-between"
	aria-label="Third navbar example">
	<div class="container-fluid">


		<button class="navbar-toggler noborder me-auto px-0" type="button" data-bs-toggle="collapse"
			data-bs-target="#navbarsExample03" aria-controls="navbarsExample03" aria-expanded="false"
			aria-label="Toggle navigation">
			<a class="navbar-brand h1 me-2" href="#">samiyan studio</a><span class="navbar-toggler-icon"></span>
		</button>


		<div class="collapse navbar-collapse" id="navbarsExample03">
			<ul class="navbar-nav me-auto mb-2 mb-sm-0">
				<li class="nav-item">
					<a class="nav-link active" aria-current="page" href="#">Home</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Link</a>
				</li>
				<li class="nav-item">
					<a class="nav-link disabled">Disabled</a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="dropdown03" data-bs-toggle="dropdown"
						aria-expanded="false">Dropdown</a>
					<ul class="dropdown-menu" aria-labelledby="dropdown03">
						<li><a class="dropdown-item" href="#">Action</a></li>
						<li><a class="dropdown-item" href="#">Another action</a></li>
						<li><a class="dropdown-item" href="#">Something else here</a></li>
					</ul>
				</li>
			</ul>

		</div>
		<div class="cntr">
			<div class="cntr-innr">
				<label class="search" for="inpt_search">
					<input id="inpt_search" type="text" />
				</label>
			</div>
		</div>
	</div>
</nav>
<!--navbar-->
<!--navbar-->
<div class="container bg-light border">
	<div class="card bg-light my-3 mx-0">
		<div class="card-header d-flex justify-content-between px-0" style="text-align:center;">
			<h4 id="message" class="text-muted p-2 border-end border-secondary">
				<div id="game-status"></div>
			</h4>
			<h1 id="scoreR" class="px-3">Red: 0</h1>
			<h1 class="px-3">Dots And Boxes</h1>
			<h1 id="scoreB" class="px-3">Blue: 0</h1>

			<h5 class="border-start border-secondary dropdown">
				<a class="nav-link dropdown-toggle text-danger p-3" href="#" id="dropdown03" data-bs-toggle="dropdown"
					aria-expanded="false ">restart</a>
				<ul class="dropdown-menu" aria-labelledby="dropdown03">
					<li><a class="text-danger p-2 dropdown-item " style="text-decoration:none;" href=""
							onclick="Del()">Reset points</a></li>
					<li>
						<p><a class="text-danger p-2 " href="#" style="text-decoration:none;">Reset board</a></p></a>
					</li>
				</ul>
			</h5>
		</div>
	</div>
	<section>
		<div class="game-grid-container"></div>
		<div id="game-status"></div>
	</section>
</div>



<footer class="d-flex flex-wrap justify-content-between align-items-center py-3  border-top">
	<div class="col-md-4 d-flex align-items-center">
		<a href="/" class="mb-3 me-2 mb-md-0 text-muted text-decoration-none lh-1">
			<img src="./static/home/Untitled-1.png" width="80" height="70" class="mx-4">
		</a>
	</div>
	<div>
		<p class=" text-light d-flex">&copy; wwww.samiyan.ir &middot; <a href="#"
				style="text-decoration:none;color:#fff;">Privacy</a> &middot; <a href="#"
				style="text-decoration:none; color:#fff;">Terms</a></p>

		<ul class="nav list-unstyled d-flex">
			<li class="ms-3"><a class="text-muted" href="tell:09129387446" title="09129387446"><i class="bi bi-phone"
						style="color:#fff; font-size:1.5rem"></i></a></li>
			<li class="ms-3"><a class="text-muted" href="mailto:mehdisamiyann@gmail.com"
					title="mehdisamiyann@gmail.com"><i class="bi bi-envelope"
						style="color:#fff; font-size:1.5rem"></i></i></a></li>
			<li class="ms-3"><a class="text-muted" href="https://t.me/samiyan1"><i class="bi bi-telegram"
						style="color:#fff; font-size:1.5rem"></i></a></li>
			<li class="ms-3"><a class="text-muted" href="https://www.instagram.com/mehdi_samiyan/"><i
						class="bi bi-instagram" style="color:#fff; font-size:1.5rem"></i></a></li>
			<li class="ms-3"><a class="text-muted" href="https://github.com/Samiyan1"><i class="bi bi-github"
						style="color:#fff; font-size:1.5rem"></i></a></li>
			<li class="ms-3"><a class="text-muted"
					href="https://www.linkedin.com/in/mehdi-samiyan-46ab621b8?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base_contact_details%3B4lRCJZaYRzqUdH2TJh7Dkg%3D%3D"><i
						class="bi bi-linkedin" style="color:#fff; font-size:1.5rem"></i></a></li>
		</ul>

	</div>
	<ul class="nav col-md-4 justify-content-end list-unstyled d-flex">

		<li class="ms-3 px-3 ">
			<p class=""><a href="#"><i class="bi bi-arrow-up-circle" style="color:#fff; font-size:2rem"></i></a>
			</p>
		</li>
	</ul>

</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
	crossorigin="anonymous"></script>

<script>


	const N = 4;
	const M = 4;
	let full = 0;
	let scoreR = 0;
	let scoreB = 0;

	let turn = "R";
	let selectedLines = [];
	let fillcondis = [
		['v-0-0', 'h-0-0', 'v-0-1', 'h-1-0'],
		['h-1-1', 'v-0-1', 'h-0-1', 'v-0-2'],
		['h-1-2', 'v-0-2', 'h-0-2', 'v-0-3'],
		['h-2-0', 'v-1-0', 'h-1-0', 'v-1-1'],
		['h-2-1', 'v-1-1', 'h-1-1', 'v-1-2'],
		['h-2-2', 'v-1-2', 'h-1-2', 'v-1-3'],
		['h-3-0', 'v-2-0', 'h-2-0', 'v-2-1'],
		['v-2-2', 'v-2-1', 'h-2-1', 'h-3-1'],
		['v-2-2', 'h-2-2', 'v-2-3', 'h-3-2'],
	];
	let wichbox = [
		['v-0-0', 'h-0-0', 'v-0-1', 'h-1-0'],
		['h-1-1', 'v-0-1', 'h-0-1', 'v-0-2'],
		['h-1-2', 'v-0-2', 'h-0-2', 'v-0-3'],
		['h-2-0', 'v-1-0', 'h-1-0', 'v-1-1'],
		['h-2-1', 'v-1-1', 'h-1-1', 'v-1-2'],
		['h-2-2', 'v-1-2', 'h-1-2', 'v-1-3'],
		['h-3-0', 'v-2-0', 'h-2-0', 'v-2-1'],
		['v-2-2', 'v-2-1', 'h-2-1', 'h-3-1'],
		['v-2-2', 'h-2-2', 'v-2-3', 'h-3-2'],
	];

	const hoverClasses = { R: "hover-red", B: "hover-blue" };
	const bgClasses = { R: "bg-red", B: "bg-blue" };

	const playersTurnText = (turn) =>
		`${turn === "R" ? "Red" : "Blue"}'s turn`;

	const isLineSelected = (line) =>
		line.classList.contains(bgClasses.R) || line.classList.contains(bgClasses.B);

	const createGameGrid = () => {

		const gameGridContainer = document.getElementsByClassName(
			"game-grid-container"
		)[0];

		const rows = Array(N)
			.fill(0)
			.map((_, i) => i);
		const cols = Array(M)
			.fill(0)
			.map((_, i) => i);

		rows.forEach((row) => {
			cols.forEach((col) => {
				const dot = document.createElement("div");
				dot.setAttribute("class", "dot");

				const hLine = document.createElement("div");
				hLine.setAttribute("class", `line-horizontal ${hoverClasses[turn]}`);
				hLine.setAttribute("id", `h-${row}-${col}`);
				hLine.addEventListener("click", handleLineClick);

				gameGridContainer.appendChild(dot);
				if (col < M - 1) gameGridContainer.appendChild(hLine);
			});

			if (row < N - 1) {
				cols.forEach((col) => {
					const vLine = document.createElement("div");
					vLine.setAttribute("class", `line-vertical ${hoverClasses[turn]}`);
					vLine.setAttribute("id", `v-${row}-${col}`);
					vLine.addEventListener("click", handleLineClick);

					const box = document.createElement("div");
					box.setAttribute("class", "box");
					box.setAttribute("id", `box-${row}-${col}`);

					gameGridContainer.appendChild(vLine);
					if (col < M - 1) gameGridContainer.appendChild(box);
				});
			}
		});

		document.getElementById("game-status").innerHTML = playersTurnText(turn);
	};

	const changeTurn = () => {
		const nextTurn = turn === "R" ? "B" : "R";

		const lines = document.querySelectorAll(".line-vertical, .line-horizontal");

		lines.forEach((l) => {
			//if line was not already selected, change it's hover color according to the next turn
			if (!isLineSelected(l)) {
				l.classList.replace(hoverClasses[turn], hoverClasses[nextTurn]);
			}
		});
		turn = nextTurn;
	};

	const handleLineClick = (e) => {

		const lineId = e.target.id;

		const selectedLine = document.getElementById(lineId);

		if (isLineSelected(selectedLine)) {
			//if line was already selected, return
			return;
		}

		selectedLines = [...selectedLines, lineId];
		checkfill();
		colorLine(selectedLine);
		changeTurn();
		document.getElementById("game-status").innerHTML = playersTurnText(turn);
		checkend();
	};

	const colorLine = (selectedLine) => {
		selectedLine.classList.remove(hoverClasses[turn]);
		selectedLine.classList.add(bgClasses[turn]);
	};





	const checkfill = () => {
		let index = -1;
		let j = -1;

		//shomare gozari boxs
		document.querySelectorAll('.box').forEach((box) => {
			j++
			box.id.remove;
			box.id = `box-${j}`
		})

		//srearch in fillcondis for squr
		let result = fillcondis.some((four) => {
			index++
			let check2 = four.every(one => selectedLines.includes(one))
			if (!check2) {
				return false
			} else {
				checksqure(four);
				fillcondis.splice(index, 1);
				checkfill()
				return true
			}
		})
		if (result) { full++ }
	}

	function checksqure(four) {
		let y = -1
		wichbox.some((array) => {
			y++
			let check3 = array.every(taki => four.includes(taki))
			if (check3) {
				document.querySelector(`#box-${y}`).classList.add(bgClasses[turn]);
				if (turn === 'B') {
					scoreB++
					document.querySelector(`#scoreB`).innerHTML = `Blue : ${scoreB}`
				}
				else {
					scoreR++
					document.querySelector(`#scoreR`).innerHTML = `Red : ${scoreR}`
				}
				return y
			}
		})

	}

	function checkend() {
		debugger
		if (full === 9) {
			if (scoreB > scoreR) {
				document.querySelector(`#game-status`).innerHTML = '<h1>Blue is Winer!!!!!!</h1>'
			}
			else if (scoreB < scoreR) {
				document.querySelector(`#game-status`).innerHTML = '<h1>Red is Winer!!!!!!</h1>'
			}
			else {
				document.querySelector(`#game-status`).innerHTML = '<h1>there is no Winer!!!!!!</h1>'
			}
		}

	}


	createGameGrid();

</script>

</body>

</html>